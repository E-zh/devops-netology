# devops-netology

## HomeWork 4.1
### Желобанов Егор DEVOPS-21

1. По скрипту:
    ```shell
    a=1
    b=2
    c=a+b
    d=$a+$b
    e=$(($a+$b))
    ```  
    * Переменной `c` будет присвоено значение `a+b`, т.к. в данном случае у нас не указан символ `$` перед именем переменных. В нашем случае это просто строка.
    * Переменной `d` будет присвоено значение `1+2`, т.к. мы указали символ `$` перед именами переменных, но арифметическая операция не указана в двойных скобках, и в нашем случае снова получается строка.
    * Переменной `e` будет присвоено значение `3`, здесь все верно указано, и имена переменных со знаком `$` и в двойных скобках.

2. Что нужно сделать чтобы исправить данный скрипт:
    * В первой строке не хватает закрывающей скобки - добавим.
    * Проверки выполняются слишком часто, тем самым забивая логи - добавим задержку `sleep`.
    * Также нужно добавить возможность выйти из цикла в случае доступности сервиса - добавим `else exit`.  
    В итоге получим такой скрипт:
    ```shell
    while ((1==1))
    do
    curl https://localhost:4757
    if (($? != 0))
    then
    date >> curl.log
    else 
    exit 
    fi
    sleep 3
    done
    ```
   
3. Необходимо написать скрипт, который проверяет доступность трёх IP: 192.168.0.1, 173.194.222.113, 87.250.250.242 по 80 порту и записывает результат в файл log. Проверять доступность необходимо пять раз для каждого узла:
    ```shell
    hosts=(192.168.0.1 173.194.222.113 87.250.250.242)
    timeout=3
    for i in {1..5}
    do
    date >>hosts.log
        for host in ${hosts[@]}
        do
        curl -Is --connect-timeout $timeout $host:80 >/dev/null
            echo "check" $host status=$? >>hosts.log
        done
    done
    ```
   
4. Необходимо дописать скрипт из предыдущего задания так, чтобы он выполнялся до тех пор, пока один из узлов не окажется недоступным. Если любой из узлов недоступен - IP этого узла пишется в файл error, скрипт прерывается:
    ```shell
    hosts=(192.168.0.1 173.194.222.113 87.250.250.242)
    timeout=3
    res=0
    
    while (($res == 0))
    do
        for host in ${hosts[@]}
        do
        curl -Is --connect-timeout $timeout $host:80 >/dev/null
        res=$?
        if (($res != 0))
        then
            echo "Error " $host status=$res >>error.log
            exit
        fi
        done
    done
    ```